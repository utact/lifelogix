# [ADR-008] 도메인 중심 모듈형 패키지 구조 채택

- **Status:** Adopted
- **Last Updated:** 2025-10-06

---

## Context (컨텍스트)

프로젝트 초기 `user` 도메인은 `controller`, `service`, `repository`, `domain` 등 기술 계층에 따라 패키지를 구성하는 전통적인 **'계층형 아키텍처 (Package by Layer)'로** 구현되었다.

그러나 `timeline` 도메인과 하위 기능들(category, activity 등)을 추가하는 과정에서, 이 구조가 프로젝트 확장 시 응집도가 떨어지고 유지보수가 어려워질 수 있다는 우려가 제기되었다. 예를 들어, `user` 관련 기능을 수정하기 위해서는 여러 패키지를 넘나들어야 했다. 이에 따라 프로젝트 전체의 패키지 구조 전략을 재검토하게 되었다.

### **고려된 대안 (Alternatives Considered)**

1.  **계층형 아키텍처 (Layered Architecture / Package by Layer)**
    - **설명**: 모든 컨트롤러는 `controller` 패키지에, 모든 서비스는 `service` 패키지에 모으는 방식.
    - **장점**: 구조가 단순하고 많은 개발자에게 익숙하다.
    - **단점**: 기능이 추가될수록 각 계층 패키지가 비대해지고, 특정 기능과 관련된 파일들이 물리적으로 분리되어 응집도가 낮아진다.

2.  **도메인 중심 모듈형 아키텍처 (Domain-Centric Architecture / Package by Feature)**
    - **설명**: `user`, `timeline` 등 비즈니스 도메인을 최상위 패키지로 구성하고, 각 도메인 패키지 내부에 필요한 계층(api, application, domain)을 두는 방식.
    - **장점**: 기능 단위로 코드가 캡슐화되어 응집도가 매우 높다. 새로운 기능을 추가하거나 기존 기능을 수정할 때 특정 모듈에만 집중할 수 있어 확장성과 유지보수성이 뛰어나다.
    - **단점**: 초기 설계에 더 많은 고민이 필요하며, 헥사고날 아키텍처 등 관련 설계 원칙에 대한 이해가 요구될 수 있다.

---

## Decision (결정)

프로젝트의 장기적인 확장성과 유지보수성을 최우선 가치로 판단하여, **'도메인 중심 모듈형 아키텍처 (Package by Feature)'를** 프로젝트 전체의 표준 패키지 구조로 채택한다.

각 도메인 모듈은 **헥사고날 아키텍처** 원칙을 따라 다음과 같은 내부 계층 구조를 가진다.

- **`domain`**: 비즈니스 로직의 핵심. Entity와 Repository 인터페이스를 포함하며 외부 기술에 의존하지 않는다.
- **`application`**: 도메인 로직을 조율하는 응용 계층. Service 클래스를 포함한다.
- **`api`**: 외부와의 접점. Controller와 DTO를 포함한다.

**최종 패키지 구조 예시:**
```
com.lifelogix
├── user
│   ├── api
│   ├── application
│   └── domain
└── timeline
    ├── category
    │   └── domain
    └── ...
```
이 구조는 **`api` → `application` → `domain`** 방향으로만 의존성을 가지며, 핵심 도메인을 외부 기술 변화로부터 보호한다.

---

## Consequences (결과)

### 긍정적
- **높은 응집도와 모듈성**: 각 기능이 독립적인 모듈처럼 구성되어 코드의 이해와 수정이 용이해진다.
- **향상된 확장성**: 새로운 비즈니스 도메인이 추가될 때, 기존 코드에 미치는 영향을 최소화하며 독립적으로 개발할 수 있다.
- **명확한 아키텍처**: 프로젝트 전체에 일관된 구조적 규칙이 적용되어 개발자 간의 협업 효율성이 증대된다.

### 부정적 (수행 과제)
- **초기 리팩토링 비용**: 기존 `user` 도메인 패키지를 새로운 표준 구조에 맞게 리팩토링하는 작업이 필요하다.
- **학습 곡선**: 팀원들이 새로운 구조와 설계 원칙에 익숙해지는 시간이 필요할 수 있다.