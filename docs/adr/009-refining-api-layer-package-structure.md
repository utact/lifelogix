# [ADR-009] API 계층 내부 패키지 구조 세분화

- **Status:** Adopted
- **Refines:** `ADR-008-domain-centric-package-structure.md`
- **Last Updated:** 2025-10-06

---

## Context (컨텍스트)

`ADR-008`을 통해 프로젝트 전체에 **도메인 중심 모듈형 패키지 구조**를 도입하기로 결정했다. 이 구조에서 `api` 패키지는 외부 세계와의 접점(Adapter) 역할을 담당하며, `Controller`와 `DTO`를 포함하기로 했다.

하지만 `Controller`와 `DTO`를 `api` 패키지 내에 함께 배치할 경우, 향후 기능이 확장됨에 따라 패키지가 비대해져 가독성과 유지보수성이 저하될 수 있다는 우려가 제기되었다.

이 결정은 헥사고날 아키텍처 원칙을 위배하지는 않는다. 헥사고날 아키텍처의 핵심은 **'무엇을 분리하는가'(애플리케이션 코어 vs. 외부)이지, '어떻게 폴더를 구성하는가'에 대한 엄격한 규칙**은 없기 때문이다. `Controller`(외부 요청을 받는 어댑터)와 `DTO`(외부와 통신하는 데이터 구조)는 모두 '외부 인터페이스'라는 하나의 역할로 볼 수 있다.

그러나 좋은 아키텍처는 이론적 원칙을 지키는 것뿐만 아니라, **실용적인 가독성과 유지보수성**을 함께 고려해야 한다.

---

## Decision (결정)

`api` 패키지의 장기적인 가독성과 확장성을 확보하기 위해, 내부 패키지를 역할에 따라 명확하게 세분화하기로 결정한다.

1.  **`api` 패키지 내부에 `controller`와 `dto` 하위 패키지를 생성한다.**
    - `controller`: `@RestController` 클래스들을 위치시킨다.
    - `dto`: 데이터 전송 객체들을 위치시킨다.

2.  **`dto` 패키지 내부에 `request`와 `response` 하위 패키지를 추가로 생성한다.**
    - `request`: 외부로부터 들어오는 요청 데이터를 담는 DTO를 위치시킨다.
    - `response`: 외부로 나가는 응답 데이터를 담는 DTO를 위치시킨다.

**최종 `api` 패키지 구조:**
```
api
├── controller
│   └── AuthController.java
└── dto
    ├── request
    │   ├── LoginRequest.java
    │   └── RegisterRequest.java
    └── response
        └── TokenResponse.java
```

---

## Consequences (결과)

### 긍정적
- **향상된 가독성**: `Controller`와 `DTO`의 물리적 분리를 통해 파일 탐색이 용이해지고 패키지의 역할이 명확해진다.
- **명확한 데이터 흐름**: `request`와 `response` DTO의 분리는 데이터의 방향성을 명시적으로 만들어 API의 의도를 파악하기 쉽게 하고, DTO의 오용을 방지한다.
- **유지보수성 증대**: 기능이 확장되어 `Controller`나 `DTO`의 개수가 늘어나도, 체계적인 구조 덕분에 관리 부담이 적다.

### 부정적
- **구조적 깊이 증가**: 패키지 깊이가 깊어져 약간의 구조적 오버헤드가 발생할 수 있으나, 그 단점보다 가독성 향상으로 얻는 이점이 훨씬 크다.