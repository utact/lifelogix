# [ADR-006] 계층적 하이브리드 카테고리 모델 채택

- **Status:** Adopted
- **Last Updated:** 2025-10-19

---

## 요약 (Summary)

데이터 분석(표준화)과 사용자 자유도(개인화)를 모두 만족시키기 위해, 시스템 기본 카테고리와 사용자 정의 카테고리를 함께 사용하는 계층적 하이브리드 모델을 채택한다.

---

## Context (컨텍스트)

활동(Activity)을 분류하는 카테고리(Category) 모델 설계 시, 사용자에게 높은 자유도를 제공하는 '개인화'와 데이터 분석 및 통계에 용이한 '표준화' 사이의 균형을 맞추는 것이 중요한 과제이다. 사용자가 직접 카테고리를 생성하게 할 경우 데이터의 일관성이 떨어지고, 시스템이 모든 카테고리를 제공할 경우 사용자의 다양한 활동을 모두 포괄하기 어렵다.

---

## Decision (결정)

**사용자 정의 카테고리와 시스템 기본 카테고리를 모두 지원하는 '계층적 하이브리드 모델'을 채택한다.**

1.  **자기참조(Self-Referencing) 관계 도입:**
    -   `Category` 엔티티에 `parent` 필드를 추가하여 부모-자식 관계의 계층 구조를 형성할 수 있도록 설계한다.

2.  **두 종류의 카테고리 운영:**
    -   **시스템 카테고리 (상위):** 관리자가 사전에 정의하는 표준 분류 기준. (예: '운동', '업무', '학습') 이 카테고리들은 `parent`가 없으며, 데이터 분석의 기준점이 된다.
    -   **사용자 정의 카테고리 (하위):** 사용자가 직접 생성하는 개인화된 카테고리. (예: '헬스장 가기', '사이드 프로젝트') 이 카테고리들은 반드시 하나의 시스템 카테고리를 `parent`로 가져야 한다.

3.  **데이터 제약 조건:**
    -   사용자는 시스템 카테고리를 직접 수정하거나 삭제할 수 없다.
    -   사용자 정의 카테고리는 반드시 부모 카테고리를 가져야 하며, 2-depth 이상의 계층 구조는 현재 허용하지 않는다.

---

## Consequences (결과)

### 긍정적
- **개인화와 표준화의 조화:** 사용자는 '헬스장 가기'와 같이 자신에게 익숙한 용어로 활동을 기록하면서도, 해당 데이터는 상위 카테고리인 '운동'으로 집계되어 일관된 데이터 분석이 가능하다.
- **풍부한 데이터 컨텍스트:** '업무'라는 큰 분류와 '주간 회의'라는 구체적인 활동을 모두 기록할 수 있어, 데이터의 의미와 가치가 풍부해진다.
- **유연한 확장성:** 향후 중첩 카테고리(3-depth 이상)나 카테고리별 통계 기능 등 다양한 기능 확장에 용이한 구조이다.

### 부정적
- **UI/UX 복잡도 증가:** 사용자가 카테고리를 생성할 때 상위 카테고리를 선택해야 하는 추가적인 UI 단계가 필요하다.
- **데이터 조회 복잡도:** 특정 활동의 상위 카테고리 정보를 함께 조회해야 하는 경우가 많아, 데이터 조회 시 JOIN 연산이 빈번하게 발생할 수 있다.
