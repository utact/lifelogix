# [ADR-005] 전역 예외 처리 전략: 동적 핸들링 채택

- **Version:** 1.0.0
- **Status:** Finalized
- **Last Updated:** 2025-10-05

이 문서는 LifeLogix 백엔드에서 발생하는 비즈니스 예외를 일관된 API 에러 응답으로 변환하기 위한 전역 예외 처리(Global Exception Handling) 전략을 정의합니다.

## 1. 배경 (Background)

- `UserService`에서 발생하는 다양한 비즈니스 예외(e.g., 이메일 중복, 로그인 실패)를 API 명세에 맞는 각각 다른 HTTP 상태 코드(e.g., 409, 401)와 표준 JSON 본문으로 변환해야 합니다.
- 향후 더 많은 커스텀 예외가 추가될 것을 고려하여, 확장 가능하고 유지보수가 용이한 예외 처리 구조를 설계할 필요가 있습니다.

## 2. 고려된 대안 (Alternatives Considered)

| 항목 | 대안 A: 명시적 핸들러 방식 | 대안 B: 동적/어노테이션 기반 방식 |
| :--- | :--- | :--- |
| **핵심 개념**| 각 예외 클래스마다 별도의 핸들러 메서드 구현 | 단일 핸들러 메서드가 `@ResponseStatus`를 동적으로 해석 |
| **장점** | 코드의 동작이 명시적이고 직관적 | **DRY 원칙 준수** 및 **높은 확장성** |
| **단점** | 예외 추가 시 핸들러 수정 필요, 코드 중복 발생 | `AnnotationUtils` 사용으로 인한 암묵적 동작 |
| **유지보수**| 예외 증가 시 핸들러 클래스의 복잡도 증가 | 예외 클래스만 관리하여 유지보수 포인트 단일화 |

## 3. 의사결정 (Decision)

**LifeLogix 프로젝트는 '대안 B: 동적/어노테이션 기반 전역 예외 처리' 방식을 채택합니다.**

이에 따라 `@RestControllerAdvice`를 사용하는 단일 핸들러가, 예외 클래스에 선언된 `@ResponseStatus` 어노테이션의 정보를 동적으로 해석하여 `ErrorResponse`를 생성하도록 구현합니다.

## 4. 선택 이유 (Rationale)

1.  **확장성 (Scalability):**
    -   프로젝트가 발전함에 따라 `ResourceNotFoundException`, `InvalidInputException` 등 수많은 커스텀 예외가 추가될 것이 자명합니다. 동적 처리 방식은 새로운 예외 클래스와 `@ResponseStatus` 어노테이션만 추가하면 되므로, 핸들러 클래스의 수정 없이도 시스템을 확장할 수 있습니다.

2.  **DRY 원칙 (Don't Repeat Yourself):**
    -   각 예외가 어떤 HTTP 상태 코드에 매핑되는지에 대한 정보는 해당 예외 클래스 내에서 단 한 번만 정의됩니다. 이는 코드의 중복을 제거하고, 상태 코드 변경 시 수정 포인트를 최소화하여 유지보수 비용을 절감합니다.

직관성이 다소 저하될 수 있다는 단점은, `GlobalExceptionHandler` 클래스에 해당 동작 방식을 명확히 주석으로 설명함으로써 충분히 보완할 수 있다고 판단했습니다. 이 전략은 장기적인 관점에서 우리 프로젝트의 **생산성(Productivity)과 안정성(Stability)에** 가장 크게 기여할 것입니다.