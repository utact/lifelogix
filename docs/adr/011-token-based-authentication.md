# [ADR-011] 토큰 기반 인증(JWT) 채택

- **Status:** Adopted
- **Last Updated:** 2025-10-19

---

## 요약 (Summary)

서버 확장성과 클라이언트 범용성을 위해, 상태를 저장하지 않는(Stateless) JWT(JSON Web Token) 기반의 토큰 인증 방식을 채택한다.

---

## Context (컨텍스트)

사용자 인증 및 세션 관리를 위한 기술 방식 선정이 필요하다. 서버의 확장성, 여러 클라이언트(웹, 모바일) 지원의 유연성, 그리고 개발 생산성을 고려하여 세션 기반 인증과 토큰 기반 인증을 비교 검토했다.

1.  **세션 기반 인증 (Session-based Authentication):** 서버가 사용자의 상태를 세션 저장소(In-memory, DB, Redis 등)에 저장하고, 클라이언트는 세션 ID를 통해 인증하는 전통적인 방식이다.
2.  **토큰 기반 인증 (Token-based Authentication):** 서버가 상태를 저장하지 않고(Stateless), 인증 정보를 암호화한 토큰(JWT)을 발급하여 클라이언트가 요청 시마다 제시하는 방식이다.

---

## Decision (결정)

**JWT(JSON Web Token)를 사용하는 토큰 기반 인증 방식을 채택한다.**

- 사용자 로그인 시, 서버는 사용자의 고유 ID(`userId`)를 포함한 JWT를 생성하여 발급한다.
- 클라이언트는 발급받은 JWT(Access Token)를 저장하고, 인증이 필요한 모든 API 요청의 `Authorization` 헤더에 `Bearer <token>` 형태로 첨부하여 전송한다.
- 서버는 각 요청을 받을 때마다 토큰의 서명을 검증하여 사용자를 인증하며, 별도의 세션 저장소를 조회하지 않는다.
- 토큰의 유효 기간을 짧게 설정하여 탈취 위험을 줄이고, 추후 필요시 Refresh Token 패턴을 도입하여 사용성을 개선한다.

---

## Consequences (결과)

### 긍정적
- **뛰어난 확장성 (Stateless):** 서버가 사용자 상태를 유지하지 않으므로, 트래픽 증가에 따른 서버 증설(Scale-out) 시 세션 불일치 문제에서 자유롭다.
- **유연성 및 범용성:** 웹, 모바일 등 다양한 클라이언트 환경에서 동일한 인증 방식을 적용하기 용이하며, CORS 문제 해결에 상대적으로 유리하다.
- **인프라 단순성:** 초기 MVP 단계에서 Redis와 같은 별도의 세션 스토리지 인프라를 구축하고 관리할 필요가 없어, 개발 복잡도와 비용이 감소한다.
- **테스트 용이성:** 각 API가 상태에 의존하지 않으므로, 독립적인 단위 테스트 및 통합 테스트 작성이 용이하다.

### 부정적
- **토큰 탈취 위험:** 토큰이 클라이언트에 저장되므로, XSS(Cross-Site Scripting) 등의 공격을 통해 토큰이 탈취될 경우 보안에 취약할 수 있다. (이는 HTTPS 적용 및 보안 헤더 설정으로 완화)
- **강제 로그아웃의 어려움:** 한 번 발급된 토큰은 만료 시점까지 유효하므로, 관리자가 특정 사용자를 즉시 로그아웃시키는 기능 구현이 복잡하다. (별도의 토큰 블랙리스트 관리 필요)
- **토큰 크기:** 토큰에 담는 정보가 많아질수록 요청 헤더의 크기가 커져 약간의 네트워크 오버헤드가 발생할 수 있다.
